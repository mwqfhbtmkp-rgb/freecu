<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FREECU â€” The City That Breaks</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
  * {
    box-sizing: border-box;
    image-rendering: pixelated;
    user-select: none;
  }

  body {
    margin: 0;
    background: #0b0f1a;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    color: #e5e7eb;
  }

  #game {
    width: 1000px;
    max-width: 100%;
    height: 320px;
    border: 3px solid #2c3145;
    background: #111827;
    position: relative;
    overflow: hidden;
  }

  /* CITY */
  #city {
    position: absolute;
    right: 80px;
    bottom: 40px;
    width: 180px;
    height: 180px;
    background:
      repeating-linear-gradient(
        0deg,
        #9ca3af 0px,
        #9ca3af 6px,
        #6b7280 6px,
        #6b7280 12px
      );
    border: 4px solid #374151;
  }

  /* CRACKS */
  .crack {
    position: absolute;
    background: rgba(0,0,0,0.35);
  }

  /* HUD */
  #hud {
    position: absolute;
    left: 20px;
    top: 20px;
    font-size: 14px;
    line-height: 1.6;
  }

  .bar {
    width: 200px;
    height: 10px;
    background: #1f2933;
    margin-top: 4px;
    border: 1px solid #374151;
  }

  .fill {
    height: 100%;
    background: #22c55e;
    width: 100%;
    transition: width 0.3s linear;
  }

  #status {
    margin-top: 12px;
    color: #facc15;
  }

  #overlay {
    position: absolute;
    inset: 0;
    background: rgba(11,15,26,0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    text-align: center;
    padding: 20px;
  }

  #overlay.hidden {
    display: none;
  }
</style>
</head>

<body>

<div id="game">

  <div id="hud">
    City Integrity
    <div class="bar"><div id="integrityFill" class="fill"></div></div>
    <div id="time">Time: 0s</div>
    <div id="status">Status: Stable</div>
  </div>

  <div id="city"></div>

  <div id="overlay">Click to begin</div>

</div>

<script>
  const overlay = document.getElementById("overlay");
  const integrityFill = document.getElementById("integrityFill");
  const statusText = document.getElementById("status");
  const timeText = document.getElementById("time");
  const city = document.getElementById("city");
  const game = document.getElementById("game");

  let integrity = 100;
  let timeSurvived = 0;
  let running = false;
  let crackCount = 0;

  function addCrack() {
    const crack = document.createElement("div");
    crack.className = "crack";
    crack.style.width = Math.random() * 60 + 20 + "px";
    crack.style.height = "4px";
    crack.style.left = Math.random() * 140 + 10 + "px";
    crack.style.top = Math.random() * 140 + 10 + "px";
    city.appendChild(crack);
  }

  function updateStatus() {
    if (integrity > 70) {
      statusText.textContent = "Status: Stable";
      statusText.style.color = "#22c55e";
    } else if (integrity > 40) {
      statusText.textContent = "Status: Structural damage";
      statusText.style.color = "#facc15";
    } else if (integrity > 15) {
      statusText.textContent = "Status: Critical integrity";
      statusText.style.color = "#f97316";
    } else {
      statusText.textContent = "Status: Imminent collapse";
      statusText.style.color = "#ef4444";
    }
  }

  function collapse() {
    running = false;
    overlay.innerHTML = `The city has collapsed<br><br>Time survived: ${timeSurvived}s`;
    overlay.classList.remove("hidden");
  }

  function loop() {
    if (!running) return;

    integrity -= 0.15;
    timeSurvived++;
    integrity = Math.max(0, integrity);

    integrityFill.style.width = integrity + "%";
    timeText.textContent = "Time: " + timeSurvived + "s";

    if (integrity < 80 && crackCount < 1) { addCrack(); crackCount++; }
    if (integrity < 60 && crackCount < 2) { addCrack(); crackCount++; }
    if (integrity < 40 && crackCount < 3) { addCrack(); crackCount++; }
    if (integrity < 25 && crackCount < 4) { addCrack(); crackCount++; }
    if (integrity < 10 && crackCount < 6) { addCrack(); crackCount++; }

    updateStatus();

    if (integrity <= 0) {
      collapse();
      return;
    }

    setTimeout(loop, 1000);
  }

  game.addEventListener("pointerdown", () => {
    if (!running) {
      integrity = 100;
      timeSurvived = 0;
      crackCount = 0;
      city.innerHTML = "";
      integrityFill.style.width = "100%";
      statusText.textContent = "Status: Stable";
      overlay.classList.add("hidden");
      running = true;
      loop();
    }
  });
</script>

</body>
</html>